function fadeOutPreloader(t,e){var n=1,i=setInterval(function(){n<=0?(t.style.zIndex=0,t.style.opacity=0,t.style.filter="alpha(opacity = 0)",document.documentElement.style.overflowY="auto",document.getElementById("preloader").remove(),clearInterval(i)):(n-=.1,t.style.opacity=n,t.style.filter="alpha(opacity = "+100*n+")")},e)}setTimeout(function(){fadeOutPreloader(document.getElementById("preloader"),69)},1500),$(document).ready(function(){particlesJS.load("landing","assets/particles.json",function(){});var t=document.getElementById("txt-rotate"),e=t.getAttribute("data-rotate"),n=t.getAttribute("data-period"),i=(setTimeout(function(){new TxtRotate(t,JSON.parse(e),n)},1500),document.createElement("style"));i.type="text/css",i.innerHTML="#txt-rotate > .wrap { border-right: 0.08em solid #666 }",document.body.appendChild(i),AOS.init({disable:"mobile",offset:200,duration:600,easing:"ease-in-sine",delay:100,once:!0}),randomizeOrder(),initSectionDock(),sortNewsFeedByDate(),sortJournalClubFeedByDate(),initCoffeeWallLayout(),initLogoRain()});var TxtRotate=function(t,e,n){this.toRotate=e,this.el=t,this.loopNum=0,this.period=parseInt(n,10)||2e3,this.txt="",this.tick(),this.isDeleting=!1};function randomizeOrder(){var t=document.getElementById("skills");if(t){for(var e=t.getElementsByTagName("div"),n=document.createDocumentFragment();e.length;)n.appendChild(e[Math.floor(Math.random()*e.length)]);t.appendChild(n)}}function initSectionDock(){var r,o,s,l,c,d,u,i,g,f,h,m,w,p,t,e,n,a,y,b,v,E,M=document.getElementById("section-dock");function j(){t.forEach(function(t){window.clearTimeout(t)}),(t=[]).push(window.setTimeout(function(){M.classList.add("is-idle-fade-1")},e)),t.push(window.setTimeout(function(){M.classList.remove("is-idle-fade-1"),M.classList.add("is-idle-fade-2")},n))}function x(){M.classList.remove("is-idle-fade-1"),M.classList.remove("is-idle-fade-2"),j()}function k(t){M.classList.toggle("is-scroll-compact",!!t)}function A(t){return t&&!t.classList.contains("section-mode-hidden")}function I(n){var t;i&&s[n]&&(Object.keys(s).forEach(function(t){var e=s[t],t=t===n;e.classList.toggle("section-mode-hidden",!t),e.setAttribute("aria-hidden",String(!t))}),t="about"===n,l&&(l.classList.toggle("section-mode-hidden",!t),l.setAttribute("aria-hidden",String(!t))),c&&(c.classList.toggle("section-mode-hidden",!t),c.setAttribute("aria-hidden",String(!t))),t="news"===n,d&&(d.classList.toggle("section-mode-hidden",!t),d.setAttribute("aria-hidden",String(!t))),u&&(u.classList.toggle("section-mode-hidden",!t),u.setAttribute("aria-hidden",String(!t))))}function L(e){r.forEach(function(t){t.classList.toggle("is-active",t.getAttribute("data-target")===e)})}function S(t,e){var n;("about"===(n=t)?m:"research"===n?w:"news"===n?p:[]).forEach(function(t){t.classList.toggle("is-active",t.getAttribute("data-target")===e)}),"about"!==t&&m.forEach(function(t){t.classList.remove("is-active")}),"research"!==t&&w.forEach(function(t){t.classList.remove("is-active")}),"news"!==t&&p.forEach(function(t){t.classList.remove("is-active")})}function B(t){t&&(t.style.left="",t.style.right="")}function F(t){var e,n,i,a={about:g,research:f,news:h}[t],t=o[t];a&&t&&a.classList.contains("is-visible")?(e=M.getBoundingClientRect(),t=t.getBoundingClientRect(),n=a.offsetWidth,e.width&&n?(t=t.left-e.left+t.width/2-n/2,t=(i=e.width-n-6)<=6?Math.max((e.width-n)/2,0):Math.min(Math.max(t,6),i),a.style.left=t+"px",a.style.right="auto"):B(a)):B(a)}function D(t,e){var e="boolean"==typeof e?e:"about"===t||"research"===t||"news"===t,n=(M.classList.toggle("is-compact",e),e&&"about"===t&&0<m.length),i=e&&"research"===t&&0<w.length,t=e&&"news"===t&&0<p.length;g&&(g.classList.toggle("is-visible",n),g.setAttribute("aria-hidden",String(!n)),n||B(g)),f&&(f.classList.toggle("is-visible",i),f.setAttribute("aria-hidden",String(!i)),i||B(f)),h&&(h.classList.toggle("is-visible",t),h.setAttribute("aria-hidden",String(!t)),t||B(h)),n?F("about"):i?F("research"):t&&F("news"),e||S("","")}function C(t,e,n){n=n||"smooth";"landing"===t?e.scrollIntoView({behavior:n,block:"start"}):(t=window.matchMedia&&window.matchMedia("(max-width: 47.99em)").matches?14:26,e=window.pageYOffset+e.getBoundingClientRect().top-t,window.scrollTo({top:Math.max(e,0),behavior:n}))}function O(t){if(!t.length)return"";var n=.35*window.innerHeight,i=t[0].getAttribute("data-target"),a=Number.POSITIVE_INFINITY;return t.forEach(function(t){var t=t.getAttribute("data-target"),e=document.getElementById(t);e&&A(e)&&((e=(e=e.getBoundingClientRect()).top<=n&&e.bottom>=n?0:Math.abs(e.top-n))<a&&(a=e,i=t))}),i}function T(t,e,n,i){if(t&&e&&A(t)&&A(e))return i="number"==typeof i?i:0,n=window.pageYOffset+window.innerHeight*("number"==typeof n?n:.35),t=t.getBoundingClientRect().top+window.pageYOffset,e=e.getBoundingClientRect().bottom+window.pageYOffset+i,t<=n&&n<=e}function N(){E||(E=!0,window.requestAnimationFrame(function(){n=.35*window.innerHeight,i=r[0].getAttribute("data-target"),a=Number.POSITIVE_INFINITY,r.forEach(function(t){var t=t.getAttribute("data-target"),e=document.getElementById(t);e&&A(e)&&((e=(e=e.getBoundingClientRect()).top<=n&&e.bottom>=n?0:Math.abs(e.top-n))<a&&(a=e,i=t))});var n,i,a,t=i,e="",o=c&&A(c)?c:l&&A(l)?l:s.about,o=(s.about&&T(s.about,o,.34)?e="about":s.research&&T(s.research,s.research)?e="research":(o=u&&A(u)?u:d&&A(d)?d:s.news,s.news&&T(s.news,o,.3,.06*window.innerHeight)&&(e="news")),"about"===(e=e||"about"!==t&&"research"!==t&&"news"!==t?e:t)||"research"===e||"news"===e?e:t);L(o),D(e,"landing"!==o),"about"===e?S("about",O(m)):"research"===e?S("research",O(w)):"news"===e?S("news",O(p)):S("",""),E=!1}))}!M||(r=Array.prototype.slice.call(M.querySelectorAll(".section-dock-link"))).length&&(o={},r.forEach(function(t){o[t.getAttribute("data-target")]=t}),s={about:document.getElementById("about"),research:document.getElementById("research"),news:document.getElementById("news")},l=document.getElementById("timeline"),c=document.getElementById("coffee"),d=document.getElementById("journal-club"),u=document.getElementById("blog"),i="true"===M.getAttribute("data-mode-toggle")&&!(!s.research||!s.news),g=document.getElementById("dock-context-about"),f=document.getElementById("dock-context-research"),h=document.getElementById("dock-context-news"),m=g?Array.prototype.slice.call(g.querySelectorAll(".dock-context-link")):[],w=f?Array.prototype.slice.call(f.querySelectorAll(".dock-context-link")):[],p=h?Array.prototype.slice.call(h.querySelectorAll(".dock-context-link")):[],t=[],e=3800,n=9500,a=window.pageYOffset||window.scrollY||0,y=10,r.forEach(function(n){n.addEventListener("click",function(t){t.preventDefault();var t=n.getAttribute("data-view"),e=(t&&I(t),n.getAttribute("data-target")),t=(!t&&i&&"about"===e&&I("about"),document.getElementById(e));t&&A(t)&&(C(e,t),L(e),t="","about"===e?t="about":"research"===e?t="research":"news"===e&&(t="news"),D(t,"landing"!==e),"about"===t?S("about","about"):"research"===t?S("research",w.length?w[0].getAttribute("data-target"):""):"news"===t?S("news","news"):S("",""),window.history&&window.history.replaceState&&window.history.replaceState(null,"","#"+e))})}),m.concat(w).concat(p).forEach(function(i){i.addEventListener("click",function(t){t.preventDefault();var t=i.getAttribute("data-context")||"",e=i.getAttribute("data-target"),n=document.getElementById(e);t&&I(t),n&&A(n)&&(C(e,n),D(t,!0),S(t,e),L("about"===t?"about":"research"===t?"research":"news"),window.history&&window.history.replaceState&&window.history.replaceState(null,"","#"+e))})}),b=window.location.hash.replace("#",""),i&&(-1!==["news","journal-club","blog"].indexOf(b)?(I("news"),D("news",!0),S("news","journal-club"===b?"journal-club":"blog"===b?"blog":"news"),L("news")):-1!==["research","projects","publications"].indexOf(b)?(I("research"),D("research",!0),S("research","research"===b?w.length?w[0].getAttribute("data-target"):"":b),L("research")):-1!==["about","timeline","coffee"].indexOf(b)?(I("about"),D("about",!0),S("about","timeline"===b?"timeline":"coffee"===b?"coffee":"about"),L("about")):(v=document.getElementById(b),D("",v=""!==b&&"landing"!==b&&!!v),v||S("",""))),b&&window.requestAnimationFrame(function(){var t=document.getElementById(b);t&&A(t)&&C(b,t,"auto")}),E=!1,window.addEventListener("scroll",function(){var t,e;t=window.pageYOffset||window.scrollY||0,e=t-a,t<=8?k(!1):y<e?k(!0):e<-y&&k(!1),a=t,x(),N()},{passive:!0}),window.addEventListener("resize",N),a=window.pageYOffset||window.scrollY||0,k(!1),x(),N())}function initCoffeeWallLayout(){var o=document.getElementById("coffee-wall-grid");if(o){var t=Array.prototype.slice.call(o.querySelectorAll(".coffee-stamp"));if(t.length){var e=null,n=[];t.forEach(function(t){!e&&t.classList.contains("is-winner")?e=t:n.push(t)});for(var i=n.length-1;0<i;--i){var a=Math.floor(Math.random()*(i+1)),r=n[i];n[i]=n[a],n[a]=r}var s,l=n.slice(),c=(e&&(s=Math.floor(l.length/2),l.splice(s,0,e)),!1);t.forEach(function(t){t=t.querySelector(".coffee-stamp-img");t&&(t.complete&&t.naturalWidth?u():(t.addEventListener("load",u),t.addEventListener("error",u)))}),window.addEventListener("resize",u,{passive:!0}),window.addEventListener("orientationchange",u,{passive:!0}),window.setTimeout(u,40),window.setTimeout(u,220),window.setTimeout(u,520)}}function y(t,e,n){for(var i=t[e],a=e+1;a<e+n;a+=1)t[a]>i&&(i=t[a]);return i}function d(){var t=window.getComputedStyle(o),e=parseFloat(t.fontSize)||16,h=(n=t,a=parseInt(n.getPropertyValue("--coffee-columns"),10),isFinite(a)&&0<a?Math.min(a,6):(a=(a=n.getPropertyValue("grid-template-columns")||"").trim())&&"none"!==a?Math.min(a.split(/\s+/).length,6):4),m=function(t,e){if(!t)return NaN;var n=parseFloat(t);return isFinite(n)?-1<t.indexOf("rem")?n*(parseFloat(window.getComputedStyle(document.documentElement).fontSize)||16):-1<t.indexOf("em")?n*(e||16):n:NaN}(t.getPropertyValue("--coffee-gap"),e),n=(isFinite(m)||(m=parseFloat(t.columnGap)),isFinite(m)||(m=parseFloat(t.rowGap)),isFinite(m)||(m=12),(!h||h<1)&&(h=1),o.clientWidth);if(n){var w=(n-m*(h-1))/h;if(0<w){for(var p=[],i=0;i<h;i+=1)p.push(0);o.classList.add("coffee-wall-grid--masonry"),l.forEach(function(t){var e=t.querySelector(".coffee-stamp-img");if(e){var n=t.classList.contains("is-winner"),i=n&&5<=h?2:1,i=Math.min(i,h),a=w*i+m*(i-1),o=n&&1<i?.75:1,r=a*o;t.style.width=r+"px",t.style.gridRowEnd="";var s=r*(e.naturalWidth?e.naturalHeight/e.naturalWidth:1),e=t.getBoundingClientRect().height||e.getBoundingClientRect().height||s,e=0<e?e:s,l=0,c=Number.POSITIVE_INFINITY;if(n&&1<i)l=Math.max(0,Math.floor((h-i)/2)),c=y(p,l,i);else for(var d=0;d<=h-i;d+=1){var u=y(p,d,i);u<c&&(c=u,l=d)}for(var s=l*(w+m),n=(o<1&&(s+=(a-r)/2),isFinite(c)?c:0),g=(t.style.left=s+"px",t.style.top=n+"px",n+e+m),f=l;f<l+i;f+=1)p[f]=g}});var a=p.length?Math.max.apply(null,p):0;o.style.height=Math.max(0,a-m)+"px"}}}function u(){c||(c=!0,window.requestAnimationFrame(function(){c=!1,d()}))}}function sortNewsFeedByDate(){var t,e=document.getElementById("combined-news-feed");!e||(t=Array.prototype.slice.call(e.querySelectorAll(".news-item"))).length&&(t.sort(function(t,e){t=parseInt(t.getAttribute("data-news-date"),10)||0;return(parseInt(e.getAttribute("data-news-date"),10)||0)-t}),t.forEach(function(t){e.appendChild(t)}),initNewsFeedPagination(e,t))}function initNewsFeedPagination(t,e){var n=document.getElementById("news-load-more");if(n){var i=document.getElementById("news-source-filters"),a=i?Array.prototype.slice.call(i.querySelectorAll("[data-news-filter]")):[],o=e&&e.length?e:Array.prototype.slice.call(t.querySelectorAll(".news-item"));if(!o.length)return n.classList.add("news-load-more-hidden"),void n.setAttribute("aria-hidden","true");var r="all",s=Math.min(5,o.length);n.addEventListener("click",function(t){t.preventDefault(),s=Math.min(l().length,s+10),d()}),a.forEach(function(e){e.addEventListener("click",function(){var t=e.getAttribute("data-news-filter")||"all";r=t,s=Math.min(5,l().length),c(),d()})}),c(),d()}function l(){return"all"===r?o:o.filter(function(t){return t.getAttribute("data-news-source")===r})}function c(){a.forEach(function(t){var e=t.getAttribute("data-news-filter")===r;t.classList.toggle("is-active",e),t.setAttribute("aria-pressed",String(e))})}function d(){var t=l(),t=(o.forEach(function(t){t.classList.add("news-item-hidden")}),t.forEach(function(t,e){t.classList.toggle("news-item-hidden",s<=e)}),s<t.length);n.classList.toggle("news-load-more-hidden",!t),n.setAttribute("aria-hidden",String(!t))}}function sortJournalClubFeedByDate(){var t,e=document.getElementById("journal-club-feed");!e||(t=Array.prototype.slice.call(e.querySelectorAll(".journal-item"))).length&&(t.sort(function(t,e){t=parseInt(t.getAttribute("data-journal-date"),10)||0;return(parseInt(e.getAttribute("data-journal-date"),10)||0)-t}),t.forEach(function(t){e.appendChild(t)}),initJournalClubPagination(e,t))}function initJournalClubPagination(t,e){var n=document.getElementById("journal-load-more");if(n){var i=document.getElementById("journal-source-filters"),a=i?Array.prototype.slice.call(i.querySelectorAll("[data-journal-filter]")):[],o=e&&e.length?e:Array.prototype.slice.call(t.querySelectorAll(".journal-item"));if(!o.length)return n.classList.add("news-load-more-hidden"),void n.setAttribute("aria-hidden","true");var r="all",s=Math.min(5,o.length);n.addEventListener("click",function(t){t.preventDefault(),s=Math.min(l().length,s+10),d()}),a.forEach(function(e){e.addEventListener("click",function(){var t=e.getAttribute("data-journal-filter")||"all";r=t,s=Math.min(5,l().length),c(),d()})}),c(),d()}function l(){return"all"===r?o:o.filter(function(t){return t.getAttribute("data-journal-source")===r})}function c(){a.forEach(function(t){var e=t.getAttribute("data-journal-filter")===r;t.classList.toggle("is-active",e),t.setAttribute("aria-pressed",String(e))})}function d(){var t=l(),t=(o.forEach(function(t){t.classList.add("news-item-hidden")}),t.forEach(function(t,e){t.classList.toggle("news-item-hidden",s<=e)}),s<t.length);n.classList.toggle("news-load-more-hidden",!t),n.setAttribute("aria-hidden",String(!t))}}function initLogoRain(){var c,d,u,t=document.getElementById("landing");function g(t,e){return t+Math.random()*(e-t)}function e(){var t,e,n,i,a,o=Math.random()<d.snowflakeChance?{kind:"snowflake",src:d.snowflakeSrcs[Math.floor(Math.random()*d.snowflakeSrcs.length)]}:{kind:"logo",src:d.logos[Math.floor(Math.random()*d.logos.length)]},r=document.createElement("span"),s=(r.className="logo-rain-drop","snowflake"===o.kind?(r.style.backgroundColor="transparent",r.style.color="transparent",e=g(d.snowflakeSizeMin,d.snowflakeSizeMax),n=g(d.snowflakeOpacityMin,d.snowflakeOpacityMax),i=g(d.snowflakeDurationMin,d.snowflakeDurationMax),a=g(d.snowflakeDriftMin,d.snowflakeDriftMax),r.classList.add("logo-rain-drop--snowflake"),r.style.backgroundImage='url("'+o.src+'")',r.style.webkitMaskImage="none",r.style.maskImage="none"):(r.style.backgroundColor=d.color,r.style.color=d.color,t=d.sizeMultiplierByLogo[o=o.src]||1,e=g(d.sizeMin,d.sizeMax)*t,n=g(d.opacityMin,d.opacityMax),i=g(d.durationMin,d.durationMax),a=g(d.driftMin,d.driftMax),r.style.backgroundImage='url("'+o+'")',r.style.webkitMaskImage='url("'+o+'")',r.style.maskImage='url("'+o+'")'),r.style.left=g(0,100)+"%",r.style.width=e.toFixed(2)+"px",r.style.height=e.toFixed(2)+"px",r.style.opacity=n.toFixed(2),r.style.animationDuration=i.toFixed(0)+"ms",r.style.setProperty("--logo-drift",a.toFixed(2)+"px"),r.style.setProperty("--logo-drift-quarter",(.25*a).toFixed(2)+"px"),r.style.setProperty("--logo-drift-mid",(.5*a).toFixed(2)+"px"),r.style.setProperty("--logo-drift-three-quarter",(.75*a).toFixed(2)+"px"),c.appendChild(r),u+=1,!1);function l(){s||(s=!0,r.remove(),u=Math.max(0,u-1))}r.addEventListener("animationend",l,{once:!0}),setTimeout(l,i+500)}t&&((c=document.createElement("div")).className="logo-rain-layer",t.appendChild(c),d={logos:["assets/img/ms8logo.png","assets/img/UoHlogo.png","assets/img/Dislogo.svg","assets/img/fulogo.png"],color:"#61B0B7",chancePerTick:.56,snowflakeChance:.6,snowflakeSrcs:["assets/img/snow0.png","assets/img/snow1.png","assets/img/snow2.png","assets/img/snow3.png","assets/img/snow4.png","assets/img/snow5.png"],tickMs:900,maxVisible:10,sizeMin:30,sizeMax:66,opacityMin:.35,opacityMax:.75,durationMin:9e3,durationMax:17e3,driftMin:-22,driftMax:22,snowflakeSizeMin:30,snowflakeSizeMax:52,snowflakeOpacityMin:.38,snowflakeOpacityMax:.72,snowflakeDurationMin:14e3,snowflakeDurationMax:24e3,snowflakeDriftMin:-22,snowflakeDriftMax:22,snowflakeSwayMin:14,snowflakeSwayMax:28,sizeMultiplierByLogo:{"assets/img/ms8logo.png":2,"assets/img/UoHlogo.png":2,"assets/img/Dislogo.svg":2,"assets/img/fulogo.png":4}},u=0,setInterval(function(){document.hidden||u>=d.maxVisible||Math.random()<d.chancePerTick&&e()},d.tickMs))}TxtRotate.prototype.tick=function(){var t=this.loopNum%this.toRotate.length,t=this.toRotate[t],e=(this.isDeleting?this.txt=t.substring(0,this.txt.length-1):this.txt=t.substring(0,this.txt.length+1),this.el.innerHTML='<span class="wrap">'+this.txt+"</span>",this),n=200-100*Math.random();this.isDeleting&&(n/=5),this.isDeleting||this.txt!==t?this.isDeleting&&""===this.txt&&(this.isDeleting=!1,this.loopNum++,n=500):(n=this.period,this.isDeleting=!0),setTimeout(function(){e.tick()},n)};